# 项目日志

> **项目名称**: 抖音账号分析Web产品
> **创建日期**: 2025-01-20
> **最后更新**: 2025-01-20

---

## 一、项目初始化记录

### 2025-01-20: 项目启动

**目标**: 将6个Prompt工作流程转化为Web产品

**输入材料**:
- 6个Prompt文件（规则、账号概况、月度趋势、爆款拆解、选题库、Word生成）
- 现有数据分析流程

**关键决策**:
1. **技术栈**: Next.js 14 + TypeScript + TailwindCSS + shadcn/ui
2. **AI服务**: 多供应商支持（Claude优先 + OpenAI备用）
3. **部署方案**: Vercel（前端/短时API）+ Railway（Python图表服务）
4. **数据库**: SQLite + Prisma（MVP阶段）
5. **认证**: MVP阶段无需用户认证

**输出**:
- 产品需求文档（PRD.md）
- 技术设计文档（technical-design.md）
- API设计文档（api-design.md）
- 数据库设计文档（database-schema.md）
- 开发计划文档（development-plan.md）

---

## 二、重要决策记录

### 决策1: 无用户认证系统

**日期**: 2025-01-20

**背景**: MVP阶段功能范围确定

**决策内容**:
- MVP作为单用户/团队内部工具
- 不实现用户认证系统
- 简化开发流程，快速交付核心功能

**理由**:
- 减少开发时间
- 降低系统复杂度
- 满足当前使用场景

**后续计划**: 完整版阶段添加用户系统

---

### 决策2: 混合部署方案

**日期**: 2025-01-20

**背景**: Vercel Serverless有10秒超时限制

**决策内容**:
- Vercel: 前端 + 短时API（上传、解析、状态查询）
- Railway: Python图表生成服务（避免超时）

**理由**:
- Vercel部署简单，适合前端和短任务
- 图表生成可能超过10秒，需要独立服务
- Railway免费额度足够MVP使用

**风险**: 跨域调用可能增加复杂度

**缓解措施**:
- 使用CORS配置
- 环境变量管理Railway URL

---

### 决策3: 内存任务队列

**日期**: 2025-01-20

**背景**: 异步任务状态管理

**决策内容**:
- MVP使用内存队列存储任务状态
- 前端轮询查询进度（每2秒）

**理由**:
- 简单实现，无需Redis
- 满足MVP单用户场景
- 快速开发

**后续计划**: 生产环境升级为Redis + BullMQ

**风险**: 服务重启会丢失任务状态

**缓解措施**:
- 任务完成后立即保存结果到数据库
- Vercel Serverless按需启动，重启影响小

---

### 决策4: AI服务优先级

**日期**: 2025-01-20

**背景**: AI服务商选择

**决策内容**:
- 优先使用Claude API
- 失败时自动切换到OpenAI
- 重试3次

**理由**:
- Claude国内访问更稳定
- 支持长文本分析
- 多供应商保障可用性

**成本考虑**:
- Claude: ~$3/百万token
- OpenAI: ~$2.5/百万token
- 预计每月100万token，成本约¥100-300

---

## 三、问题与解决方案

### 问题1: Vercel文件系统只读

**问题描述**:
Vercel Serverless函数的文件系统是只读的，无法持久化SQLite数据库

**解决方案**:
- 使用Vercel Blob存储SQLite文件
- 或接受部署时数据库重置（MVP可接受）
- 完整版迁移到PostgreSQL（Neon/Supabase）

**状态**: MVP阶段接受重置，后续升级

---

### 问题2: 跨域调用Python服务

**问题描述**:
Vercel调用Railway的Python服务可能遇到CORS问题

**解决方案**:
- Python FastAPI配置CORS中间件
- 使用环境变量管理服务URL
- 添加错误处理和重试

**状态**: 待实现

---

## 四、里程碑完成记录

### 里程碑1: 文档完成 ✅

**日期**: 2025-01-20

**完成内容**:
- [x] PRD文档（v1.1）
- [x] 技术设计文档
- [x] API设计文档
- [x] 数据库设计文档
- [x] 开发计划文档
- [x] 项目日志文档

**下一步**: 开始Week 1开发

---

### 里程碑2: 待完成

**预计日期**: Week 1结束

**计划内容**:
- [ ] 项目初始化
- [ ] 文件上传功能
- [ ] 文件解析功能
- [ ] 列映射组件

---

### 里程碑3: 待完成

**预计日期**: Week 2结束

**计划内容**:
- [ ] 数据计算引擎
- [ ] AI服务集成
- [ ] 异步任务系统
- [ ] 分析流程整合

---

### 里程碑4: 待完成

**预计日期**: Week 3结束

**计划内容**:
- [ ] Python图表服务
- [ ] 报告生成
- [ ] Vercel部署
- [ ] Railway部署
- [ ] 测试与修复

---

## 五、技术债务记录

### 当前技术债务

| 项目 | 描述 | 计划解决时间 |
|------|------|--------------|
| 数据持久化 | SQLite在Vercel部署会重置 | 完整版阶段迁移PostgreSQL |
| 任务队列 | 内存队列不支持多实例 | 完整版阶段升级Redis |
| 前端轮询 | 效率不如WebSocket | 优化阶段实现WebSocket |
| 错误处理 | 部分错误处理不够完善 | 开发过程中持续优化 |

---

## 六、性能基准

### 目标性能指标

| 指标 | 目标值 | 实际值 | 状态 |
|------|--------|--------|------|
| 文件上传 | < 10秒 | - | 待测试 |
| 数据解析 | < 10秒 | - | 待测试 |
| 完整分析 | < 3分钟 | - | 待测试 |
| API响应 | < 1秒 | - | 待测试 |

---

## 七、成本跟踪

### 开发成本

| 阶段 | 预计 | 实际 | 状态 |
|------|------|------|------|
| MVP开发 | ¥45,000 | - | 进行中 |
| 测试 | ¥5,000 | - | 待开始 |

### 运营成本（月度）

| 项目 | 预算 | 实际 | 状态 |
|------|------|------|------|
| Vercel Pro | ¥140 | - | 待部署 |
| Vercel Blob | ¥50 | - | 待部署 |
| AI服务 | ¥100-300 | - | 待统计 |
| Railway | ¥0（免费） | - | 待部署 |
| **合计** | **¥290-490** | - | 待统计 |

---

## 八、变更记录

### 2025-01-20

**变更内容**:
- 创建所有项目文档
- 确定MVP架构和技术栈
- 制定3周开发计划

**影响**:
- 项目正式启动
- 进入开发阶段

---

## 九、会议记录

### 2025-01-20: 需求确认会

**参与者**: 产品、开发

**讨论内容**:
- MVP功能范围确认
- 技术栈选择
- 部署方案确定
- 时间线确认

**决议**:
- MVP包含全部4个核心功能
- 使用Next.js + shadcn/ui
- Vercel + Railway混合部署
- 3周完成MVP

---

## 十、下一步行动

### 立即行动

1. 开始Week 1 Day 1: 项目初始化
2. 创建GitHub仓库
3. 配置开发环境

### 本周目标

1. 完成项目初始化
2. 实现文件上传功能
3. 实现文件解析功能
4. 实现列映射组件

### 本月目标

1. 完成MVP开发
2. 部署到生产环境
3. 完成端到端测试

---

*本文档将在项目进行中持续更新，记录所有重要事件和决策。*
